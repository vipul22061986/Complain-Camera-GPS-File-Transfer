/* Gmap3 */
(function(e,t){function i(){if(!n){n={verbose:false,queryLimit:{attempt:5,delay:250,random:250},classes:{Map:google.maps.Map,Marker:google.maps.Marker,InfoWindow:google.maps.InfoWindow,Circle:google.maps.Circle,Rectangle:google.maps.Rectangle,OverlayView:google.maps.OverlayView,StreetViewPanorama:google.maps.StreetViewPanorama,KmlLayer:google.maps.KmlLayer,TrafficLayer:google.maps.TrafficLayer,BicyclingLayer:google.maps.BicyclingLayer,GroundOverlay:google.maps.GroundOverlay,StyledMapType:google.maps.StyledMapType,ImageMapType:google.maps.ImageMapType},map:{mapTypeId:google.maps.MapTypeId.ROADMAP,center:[46.578498,2.457275],zoom:2},overlay:{pane:"floatPane",content:"",offset:{x:0,y:0}},geoloc:{getCurrentPosition:{maximumAge:6e4,timeout:5e3}}}}}function s(e,n){return e!==t?e:"gmap3_"+(n?r+1:r++)}function o(t,n,r,i,s){if(n.todo.events||n.todo.onces){var o={id:i,data:n.todo.data,tag:n.todo.tag}}if(n.todo.events){e.each(n.todo.events,function(e,n){google.maps.event.addListener(r,e,function(e){n.apply(t,[s?s:r,e,o])})})}if(n.todo.onces){e.each(n.todo.onces,function(e,n){google.maps.event.addListenerOnce(r,e,function(e){n.apply(t,[s?s:r,e,o])})})}}function u(){var e=[];this.empty=function(){return!e.length};this.add=function(t){e.push(t)};this.get=function(){return e.length?e[0]:false};this.ack=function(){e.shift()}}function a(t,r,i){function f(e){var t={};t[e]={};return t}function l(){var e;for(e in i){if(e in s){continue}return e}}var s={},o=this,u,a={latLng:{map:false,marker:false,infowindow:false,circle:false,overlay:false,getlatlng:false,getmaxzoom:false,getelevation:false,streetviewpanorama:false,getaddress:true},geoloc:{getgeoloc:true}};if(typeof i==="string"){i=f(i)}this.run=function(){var o,f;while(o=l()){if(typeof t[o]==="function"){u=o;f=e.extend(true,{},n[o]||{},i[o].options||{});if(o in a.latLng){if(i[o].values){M(i[o].values,t,t[o],{todo:i[o],opts:f,session:s})}else{O(t,t[o],a.latLng[o],{todo:i[o],opts:f,session:s})}}else if(o in a.geoloc){_(t,t[o],{todo:i[o],opts:f,session:s})}else{t[o].apply(t,[{todo:i[o],opts:f,session:s}])}return}else{s[o]=null}}r.apply(t,[i,s])};this.ack=function(e){s[u]=e;o.run.apply(o,[])}}function f(e){var t,n=[];for(t in e){n.push(t)}return n}function l(t,n){var r={};if(t.todo){for(var i in t.todo){if(i!=="options"&&i!=="values"){r[i]=t.todo[i]}}}var s,o=["data","tag","id","events","onces"];for(s=0;s<o.length;s++){c(r,o[s],n,t.todo)}r.options=e.extend({},t.todo.options||{},n.options||{});return r}function c(e,t){for(var n=2;n<arguments.length;n++){if(t in arguments[n]){e[t]=arguments[n][t];return}}}function h(){var e=[];this.get=function(t){if(e.length){var n,r,i,s,o,u=f(t);for(n=0;n<e.length;n++){s=e[n];o=u.length==s.keys.length;for(r=0;r<u.length&&o;r++){i=u[r];o=i in s.request;if(o){if(typeof t[i]==="object"&&"equals"in t[i]&&typeof t[i]==="function"){o=t[i].equals(s.request[i])}else{o=t[i]===s.request[i]}}}if(o){return s.results}}}};this.store=function(t,n){e.push({request:t,keys:f(t),results:n})}}function p(t,r,i,s){var o=this,u=[];n.classes.OverlayView.call(this);this.setMap(t);this.onAdd=function(){var t=this.getPanes();if(r.pane in t){e(t[r.pane]).append(s)}};this.getPosition=function(){return i};this.draw=function(){var t=this.getProjection().fromLatLngToDivPixel(i);s.css("left",t.x+r.offset.x+"px").css("top",t.y+r.offset.y+"px");e.each("dblclick click mouseover mousemove mouseout mouseup mousedown".split(" "),function(t,n){u.push(google.maps.event.addDomListener(s[0],n,function(t){e.Event(t).stopPropagation();google.maps.event.trigger(o,n,[t])}))});u.push(google.maps.event.addDomListener(s[0],"contextmenu",function(t){e.Event(t).stopPropagation();google.maps.event.trigger(o,"rightclick",[t])}))};this.onRemove=function(){for(var e=0;e<u.length;e++){google.maps.event.removeListener(u[e])}s.remove()};this.hide=function(){s.hide()};this.show=function(){s.show()};this.toggle=function(){if(s){if(s.is(":visible")){this.show()}else{this.hide()}}};this.toggleDOM=function(){if(this.getMap()){this.setMap(null)}else{this.setMap(t)}};this.getDOMElement=function(){return s[0]}}function d(e){function t(){this.onAdd=function(){};this.onRemove=function(){};this.draw=function(){};return n.classes.OverlayView.apply(this,[])}t.prototype=n.classes.OverlayView.prototype;var r=new t;r.setMap(e);return r}function v(n,r,i,u){function k(){x=E.getProjection();if(!x){setTimeout(function(){k.apply(p,[])},25);return}c=true;v.push(google.maps.event.addListener(r,"zoom_changed",function(){_()}));v.push(google.maps.event.addListener(r,"bounds_changed",function(){_()}));P()}function L(e){if(typeof m[e]==="object"){if(typeof m[e].obj.setMap==="function"){m[e].obj.setMap(null)}if(typeof m[e].obj.remove==="function"){m[e].obj.remove()}if(typeof m[e].shadow.remove==="function"){m[e].obj.remove()}if(typeof m[e].shadow.setMap==="function"){m[e].shadow.setMap(null)}delete m[e].obj;delete m[e].shadow}else if(y[e]){y[e].setMap(null)}delete m[e]}function A(){var e,t,n,r,i,s,o,u;if(arguments[0]instanceof google.maps.LatLng){e=arguments[0].lat();n=arguments[0].lng();if(arguments[1]instanceof google.maps.LatLng){t=arguments[1].lat();r=arguments[1].lng()}else{t=arguments[1];r=arguments[2]}}else{e=arguments[0];n=arguments[1];if(arguments[2]instanceof google.maps.LatLng){t=arguments[2].lat();r=arguments[2].lng()}else{t=arguments[2];r=arguments[3]}}i=Math.PI*e/180;s=Math.PI*n/180;o=Math.PI*t/180;u=Math.PI*r/180;return 1e3*6371*Math.acos(Math.min(Math.cos(i)*Math.cos(o)*Math.cos(s)*Math.cos(u)+Math.cos(i)*Math.sin(s)*Math.cos(o)*Math.sin(u)+Math.sin(i)*Math.sin(o),1))}function O(){var e=A(r.getCenter(),r.getBounds().getNorthEast()),t=new google.maps.Circle({center:r.getCenter(),radius:1.25*e});return t.getBounds()}function M(){var e={},t;for(t in m){e[t]=true}return e}function _(){clearTimeout(S);S=setTimeout(function(){P()},25)}function D(e){var t=x.fromLatLngToDivPixel(e),n=x.fromDivPixelToLatLng(new google.maps.Point(t.x+i,t.y-i)),r=x.fromDivPixelToLatLng(new google.maps.Point(t.x-i,t.y+i));return new google.maps.LatLngBounds(r,n)}function P(){if(a||l||!c){return}var n=[],i={},s=r.getZoom(),o=u!==t&&s>u,p=M(),d,v,g,y,E,S,x,C=false,k,A;f=false;if(s>3){k=O();C=k.getSouthWest().lng()<k.getNorthEast().lng()}e.each(b,function(e,t){if(!t){return}if(C&&!k.contains(t.options.position)){return}if(T&&!T(w[e])){return}n.push(e)});while(1){d=0;while(i[d]&&d<n.length){d++}if(d==n.length){break}S=[];if(h&&!o){do{x=S;S=[];if(x.length){y=E=0;for(g=0;g<x.length;g++){y+=b[n[x[g]]].options.position.lat();E+=b[n[x[g]]].options.position.lng()}y/=x.length;E/=x.length;k=D(new google.maps.LatLng(y,E))}else{k=D(b[n[d]].options.position)}for(v=d;v<n.length;v++){if(i[v]){continue}if(k.contains(b[n[v]].options.position)){S.push(v)}}}while(x.length<S.length&&S.length>1)}else{for(v=d;v<n.length;v++){if(i[v]){continue}S.push(v);break}}A={latLng:k.getCenter(),indexes:[],ref:[]};for(g=0;g<S.length;g++){i[S[g]]=true;A.indexes.push(n[S[g]]);A.ref.push(n[S[g]])}A.ref=A.ref.join("-");if(A.ref in p){delete p[A.ref]}else{if(S.length===1){m[A.ref]=true}(function(e){setTimeout(function(){N(e)},1)})(A)}}e.each(p,function(e){L(e)});l=false}var a=false,f=false,l=false,c=false,h=true,p=this,v=[],m={},g={},y=[],b=[],w=[],E=d(r),S,x,T,N,C;k();this.getById=function(e){return e in g?y[g[e]]:false};this.clearById=function(e){if(e in g){var t=g[e];if(y[t]){y[t].setMap(null)}delete y[t];y[t]=false;delete b[t];b[t]=false;delete w[t];w[t]=false;delete g[e];f=true}};this.add=function(e,t){e.id=s(e.id);this.clearById(e.id);g[e.id]=y.length;y.push(null);b.push(e);w.push(t);f=true};this.addMarker=function(e,t){t=t||{};t.id=s(t.id);this.clearById(t.id);if(!t.options){t.options={}}t.options.position=e.getPosition();o(n,{todo:t},e,t.id);g[t.id]=y.length;y.push(e);b.push(t);w.push(t.data||{});f=true};this.todo=function(e){return b[e]};this.value=function(e){return w[e]};this.marker=function(e){return y[e]};this.setMarker=function(e,t){y[e]=t};this.store=function(e,t,n){m[e.ref]={obj:t,shadow:n}};this.free=function(){for(var t=0;t<v.length;t++){google.maps.event.removeListener(v[t])}v=[];e.each(m,function(e){L(e)});m={};e.each(b,function(e){b[e]=null});b=[];e.each(y,function(e){if(y[e]){y[e].setMap(null);delete y[e]}});y=[];e.each(w,function(e){delete w[e]});w=[];g={}};this.filter=function(e){T=e;P()};this.enable=function(e){if(h!=e){h=e;P()}};this.display=function(e){N=e};this.error=function(e){C=e};this.beginUpdate=function(){a=true};this.endUpdate=function(){a=false;if(f){P()}}}function m(e,t){this.id=function(){return e};this.filter=function(e){t.filter(e)};this.enable=function(){t.enable(true)};this.disable=function(){t.enable(false)};this.add=function(e,n,r){if(!r){t.beginUpdate()}t.addMarker(e,n);if(!r){t.endUpdate()}};this.getById=function(e){return t.getById(e)};this.clearById=function(e,n){if(!n){t.beginUpdate()}t.clearById(e);if(!n){t.endUpdate()}}}function g(){function i(n){if(n){if(typeof n==="function"){return n}n=k(n);return function(r){if(r===t){return false}if(typeof r==="object"){for(var i=0;i<r.length;i++){if(e.inArray(r[i],n)>=0){return true}}return false}return e.inArray(r,n)>=0}}}function o(e){return{id:e.id,name:e.name,object:e.obj,tag:e.tag,data:e.data}}function u(e){if(typeof e.setMap==="function"){e.setMap(null)}if(typeof e.remove==="function"){e.remove()}if(typeof e.free==="function"){e.free()}e=null}var n={},r={};this.add=function(e,t,i,o){var u=e.todo||{},a=s(u.id);if(!n[t]){n[t]=[]}if(a in r){this.clearById(a)}r[a]={obj:i,sub:o,name:t,id:a,tag:u.tag,data:u.data};n[t].push(a);return a};this.getById=function(e,t,n){if(e in r){if(t){return r[e].sub}else if(n){return o(r[e])}return r[e].obj}return false};this.get=function(e,t,s,u){var a,f,l=i(s);if(!n[e]||!n[e].length){return null}a=n[e].length;while(a){a--;f=n[e][t?a:n[e].length-a-1];if(f&&r[f]){if(l&&!l(r[f].tag)){continue}return u?o(r[f]):r[f].obj}}return null};this.all=function(e,s,u){var a=[],f=i(s),l=function(e){var t,i;for(t=0;t<n[e].length;t++){i=n[e][t];if(i&&r[i]){if(f&&!f(r[i].tag)){continue}a.push(u?o(r[i]):r[i].obj)}}};if(e in n){l(e)}else if(e===t){for(e in n){l(e)}}return a};this.rm=function(e,t,i){var s,o;if(!n[e]){return false}if(t){if(i){for(s=n[e].length-1;s>=0;s--){o=n[e][s];if(t(r[o].tag)){break}}}else{for(s=0;s<n[e].length;s++){o=n[e][s];if(t(r[o].tag)){break}}}}else{s=i?n[e].length-1:0}if(!(s in n[e])){return false}return this.clearById(n[e][s],s)};this.clearById=function(e,i){if(e in r){var s,o=r[e].name;for(s=0;i===t&&s<n[o].length;s++){if(e===n[o][s]){i=s}}u(r[e].obj);if(r[e].sub){u(r[e].sub)}delete r[e];n[o].splice(i,1);return true}return false};this.objGetById=function(e){var t;if(n["clusterer"]){for(var i in n["clusterer"]){if((t=r[n["clusterer"][i]].obj.getById(e))!==false){return t}}}return false};this.objClearById=function(e){if(n["clusterer"]){for(var t in n["clusterer"]){if(r[n["clusterer"][t]].obj.clearById(e)){return true}}}return null};this.clear=function(e,t,r,s){var o,u,a,f=i(s);if(!e||!e.length){e=[];for(o in n){e.push(o)}}else{e=k(e)}for(u=0;u<e.length;u++){if(e[u]){a=e[u];if(!n[a]){continue}if(t){this.rm(a,f,true)}else if(r){this.rm(a,f,false)}else{while(this.rm(a,f,false));}}}}}function w(){if(!y.geocoder){y.geocoder=new google.maps.Geocoder}return y.geocoder}function E(){if(!y.directionsService){y.directionsService=new google.maps.DirectionsService}return y.directionsService}function S(){if(!y.elevationService){y.elevationService=new google.maps.ElevationService}return y.elevationService}function x(){if(!y.maxZoomService){y.maxZoomService=new google.maps.MaxZoomService}return y.maxZoomService}function T(){if(!y.distanceMatrixService){y.distanceMatrixService=new google.maps.DistanceMatrixService}return y.distanceMatrixService}function N(){if(n.verbose){var e,t=[];if(window.console&&typeof console.log==="function"){for(e=0;e<arguments.length;e++){t.push(arguments[e])}console.log.apply(console,t)}else{t="";for(e=0;e<arguments.length;e++){t+=arguments[e].toString()+" "}alert(t)}}}function C(e){return(typeof e==="number"||typeof e==="string")&&e!==""&&!isNaN(e)}function k(e){var n,r=[];if(e!==t){if(typeof e==="object"){if(typeof e.length==="number"){r=e}else{for(n in e){r.push(e[n])}}}else{r.push(e)}}return r}function L(t,n,r){var i=n?t:null;if(!t||typeof t==="string"){return i}if(t.latLng){return L(t.latLng)}if(t instanceof google.maps.LatLng){return t}else if(C(t.lat)){return new google.maps.LatLng(t.lat,t.lng)}else if(!r&&e.isArray(t)){if(!C(t[0])||!C(t[1])){return i}return new google.maps.LatLng(t[0],t[1])}return i}function A(t){var n,r;if(!t||t instanceof google.maps.LatLngBounds){return t||null}if(e.isArray(t)){if(t.length==2){n=L(t[0]);r=L(t[1])}else if(t.length==4){n=L([t[0],t[1]]);r=L([t[2],t[3]])}}else{if("ne"in t&&"sw"in t){n=L(t.ne);r=L(t.sw)}else if("n"in t&&"e"in t&&"s"in t&&"w"in t){n=L([t.n,t.e]);r=L([t.s,t.w])}}if(n&&r){return new google.maps.LatLngBounds(r,n)}return null}function O(e,t,r,i,s){var o=r?L(i.todo,false,true):false,u=o?{latLng:o}:i.todo.address?typeof i.todo.address==="string"?{address:i.todo.address}:i.todo.address:false,a=u?b.get(u):false,f=this;if(u){s=s||0;if(a){i.latLng=a.results[0].geometry.location;i.results=a.results;i.status=a.status;t.apply(e,[i])}else{if(u.location){u.location=L(u.location)}if(u.bounds){u.bounds=A(u.bounds)}w().geocode(u,function(o,a){if(a===google.maps.GeocoderStatus.OK){b.store(u,{results:o,status:a});i.latLng=o[0].geometry.location;i.results=o;i.status=a;t.apply(e,[i])}else if(a===google.maps.GeocoderStatus.OVER_QUERY_LIMIT&&s<n.queryLimit.attempt){setTimeout(function(){O.apply(f,[e,t,r,i,s+1])},n.queryLimit.delay+Math.floor(Math.random()*n.queryLimit.random))}else{N("geocode failed",a,u);i.latLng=i.results=false;i.status=a;t.apply(e,[i])}})}}else{i.latLng=L(i.todo,false,true);t.apply(e,[i])}}function M(t,n,r,i){function u(){do{o++}while(o<t.length&&!("address"in t[o]));if(o>=t.length){r.apply(n,[i]);return}O(s,function(n){delete n.todo;e.extend(t[o],n);u.apply(s,[])},true,{todo:t[o]})}var s=this,o=-1;u()}function _(e,t,n){var r=false;if(navigator&&navigator.geolocation){navigator.geolocation.getCurrentPosition(function(i){if(r){return}r=true;n.latLng=new google.maps.LatLng(i.coords.latitude,i.coords.longitude);t.apply(e,[n])},function(){if(r){return}r=true;n.latLng=false;t.apply(e,[n])},n.opts.getCurrentPosition)}else{n.latLng=false;t.apply(e,[n])}}function D(r){function y(){if(!d&&(d=f.get())){d.run()}}function b(){d=null;f.ack();y.call(i)}function w(t){var n,i=[];for(n=1;n<arguments.length;n++){i.push(arguments[n])}if(typeof t.todo.callback==="function"){t.todo.callback.apply(r,i)}else if(typeof t.todo.callback==="object"){e.each(t.todo.callback,function(e,t){if(typeof t==="function"){t.apply(r,i)}})}}function C(e,t,n){if(n){o(r,e,t,n)}w(e,t);d.ack(t)}function O(t,i){i=i||{};if(h){if(i.todo&&i.todo.options){h.setOptions(i.todo.options)}}else{var s=i.opts||e.extend(true,{},n.map,i.todo&&i.todo.options?i.todo.options:{});s.center=t||L(s.center);h=new n.classes.Map(r.get(0),s)}}function M(t,n,i){var s=[],u="values"in t.todo;if(!u){t.todo.values=[{options:t.opts}]}if(!t.todo.values.length){C(t,false);return}O();e.each(t.todo.values,function(u,a){var f,p,d,v,m=l(t,a);if(m.options[i]){if(m.options[i][0][0]&&e.isArray(m.options[i][0][0])){for(p=0;p<m.options[i].length;p++){for(d=0;d<m.options[i][p].length;d++){m.options[i][p][d]=L(m.options[i][p][d])}}}else{for(p=0;p<m.options[i].length;p++){m.options[i][p]=L(m.options[i][p])}}}m.options.map=h;v=new google.maps[n](m.options);s.push(v);f=c.add({todo:m},n.toLowerCase(),v);o(r,{todo:m},v,f)});C(t,u?s:s[0])}function _(s){var u=new v(r,h,s.radius,s.maxZoom),a={},f={},l=/^[0-9]+$/,c,p;for(p in s){if(l.test(p)){f[p]=s[p];f[p].width=f[p].width||0;f[p].height=f[p].height||0}else{a[p]=s[p]}}if(a.calculator){c=function(t){var n=[];e.each(t,function(e,t){n.push(u.value(t))});return a.calculator.apply(r,[n])}}else{c=function(e){return e.length}}u.error(function(){N.apply(i,arguments)});u.display(function(s){var l,p,d=0,v,m,g,y=c(s.indexes);if(y>1){for(l in f){if(l>d&&l<=y){d=l}}p=f[d]}if(p){g=p.offset||[-p.width/2,-p.height/2];v=e.extend({},a);v.options=e.extend({pane:"overlayLayer",content:p.content?p.content.replace("CLUSTER_COUNT",y):"",offset:{x:("x"in g?g.x:g[0])||0,y:("y"in g?g.y:g[1])||0}},a.options||{});m=i.overlay({todo:v,opts:v.options,latLng:L(s)},true);v.options.pane="floatShadow";v.options.content=e(document.createElement("div")).width(p.width+"px").height(p.height+"px");shadow=i.overlay({todo:v,opts:v.options,latLng:L(s)},true);a.data={latLng:L(s),markers:[]};e.each(s.indexes,function(e,t){a.data.markers.push(u.value(t));if(u.marker(t)){u.marker(t).setMap(null)}});o(r,{todo:a},shadow,t,{main:m,shadow:shadow});u.store(s,m,shadow)}else{e.each(s.indexes,function(e,t){if(u.marker(t)){u.marker(t).setMap(h)}else{var i=u.todo(t),s=new n.classes.Marker(i.options);u.setMarker(t,s);o(r,{todo:i},s,i.id)}})}});return u}var i=this,f=new u,c=new g,h=null,d;this._plan=function(e){for(var t=0;t<e.length;t++){f.add(new a(i,b,e[t]))}y()};this.map=function(e){O(e.latLng,e);o(r,e,h);C(e,h)};this.destroy=function(e){c.clear();r.empty();if(h){h=null}C(e,true)};this.infowindow=function(i){var s=[],u="values"in i.todo;if(!u){if(i.latLng){i.opts.position=i.latLng}else if(i.opts.position){i.opts.position=L(i.opts.position)}i.todo.values=[{options:i.opts}]}e.each(i.todo.values,function(e,a){var f,p,d=l(i,a);if(!h){O(d.options.position)}p=new n.classes.InfoWindow(d.options);if(p&&(d.open===t||d.open)){if(u){p.open(h,d.anchor?d.anchor:t)}else{p.open(h,d.anchor?d.anchor:i.latLng?t:i.session.marker?i.session.marker:t)}}s.push(p);f=c.add({todo:d},"infowindow",p);o(r,{todo:d},p,f)});C(i,u?s:s[0])};this.circle=function(t){var i=[],s="values"in t.todo;if(!s){t.opts.center=t.latLng||L(t.opts.center);t.todo.values=[{options:t.opts}]}if(!t.todo.values.length){C(t,false);return}e.each(t.todo.values,function(e,s){var u,a,f=l(t,s);f.options.center=f.options.center?L(f.options.center):L(s);if(!h){O(f.options.center)}f.options.map=h;a=new n.classes.Circle(f.options);i.push(a);u=c.add({todo:f},"circle",a);o(r,{todo:f},a,u)});C(t,s?i:i[0])};this.overlay=function(t,r){var i,s,o=e(document.createElement("div")).css("border","none").css("borderWidth","0px").css("position","absolute");o.append(t.opts.content);p.prototype=new n.classes.OverlayView;s=new p(h,t.opts,t.latLng,o);o=null;if(r){return s}i=c.add(t,"overlay",s);C(t,s,i)};this.getaddress=function(e){w(e,e.results,e.status);d.ack()};this.getlatlng=function(e){w(e,e.results,e.status);d.ack()};this.getmaxzoom=function(e){x().getMaxZoomAtLatLng(e.latLng,function(t){w(e,t.status===google.maps.MaxZoomStatus.OK?t.zoom:false,status);d.ack()})};this.getelevation=function(e){var t,n=[],r=function(t,n){w(e,n===google.maps.ElevationStatus.OK?t:false,n);d.ack()};if(e.latLng){n.push(e.latLng)}else{n=k(e.todo.locations||[]);for(t=0;t<n.length;t++){n[t]=L(n[t])}}if(n.length){S().getElevationForLocations({locations:n},r)}else{if(e.todo.path&&e.todo.path.length){for(t=0;t<e.todo.path.length;t++){n.push(L(e.todo.path[t]))}}if(n.length){S().getElevationAlongPath({path:n,samples:e.todo.samples},r)}else{d.ack()}}};this.defaults=function(t){e.each(t.todo,function(t,r){if(typeof n[t]==="object"){n[t]=e.extend({},n[t],r)}else{n[t]=r}});d.ack(true)};this.rectangle=function(t){var i=[],s="values"in t.todo;if(!s){t.todo.values=[{options:t.opts}]}if(!t.todo.values.length){C(t,false);return}e.each(t.todo.values,function(e,s){var u,a,f=l(t,s);f.options.bounds=f.options.bounds?A(f.options.bounds):A(s);if(!h){O(f.options.bounds.getCenter())}f.options.map=h;a=new n.classes.Rectangle(f.options);i.push(a);u=c.add({todo:f},"rectangle",a);o(r,{todo:f},a,u)});C(t,s?i:i[0])};this.polyline=function(e){M(e,"Polyline","path")};this.polygon=function(e){M(e,"Polygon","paths")};this.trafficlayer=function(e){O();var t=c.get("trafficlayer");if(!t){t=new n.classes.TrafficLayer;t.setMap(h);c.add(e,"trafficlayer",t)}C(e,t)};this.bicyclinglayer=function(e){O();var t=c.get("bicyclinglayer");if(!t){t=new n.classes.BicyclingLayer;t.setMap(h);c.add(e,"bicyclinglayer",t)}C(e,t)};this.groundoverlay=function(e){e.opts.bounds=A(e.opts.bounds);if(e.opts.bounds){O(e.opts.bounds.getCenter())}var t,r=new n.classes.GroundOverlay(e.opts.url,e.opts.bounds,e.opts.opts);r.setMap(h);t=c.add(e,"groundoverlay",r);C(e,r,t)};this.streetviewpanorama=function(t){if(!t.opts.opts){t.opts.opts={}}if(t.latLng){t.opts.opts.position=t.latLng}else if(t.opts.opts.position){t.opts.opts.position=L(t.opts.opts.position)}if(t.todo.divId){t.opts.container=document.getElementById(t.todo.divId)}else if(t.opts.container){t.opts.container=e(t.opts.container).get(0)}var r,i=new n.classes.StreetViewPanorama(t.opts.container,t.opts.opts);if(i){h.setStreetView(i)}r=c.add(t,"streetviewpanorama",i);C(t,i,r)};this.kmllayer=function(t){var i=[],s="values"in t.todo;if(!s){t.todo.values=[{options:t.opts}]}if(!t.todo.values.length){C(t,false);return}e.each(t.todo.values,function(e,s){var u,a,f=l(t,s);if(!h){O()}f.options.opts.map=h;a=new n.classes.KmlLayer(f.options.url,f.options.opts);i.push(a);u=c.add({todo:f},"kmllayer",a);o(r,{todo:f},a,u)});C(t,s?i:i[0])};this.panel=function(n){O();var i,s=0,o=0,u,a=e(document.createElement("div"));a.css("position","absolute").css("z-index","1000");if(n.opts.content){u=e(n.opts.content);if(n.opts.left!==t){s=n.opts.left}else if(n.opts.right!==t){s=r.width()-u.width()-n.opts.right}else if(n.opts.center){s=(r.width()-u.width())/2}if(n.opts.top!==t){o=n.opts.top}else if(n.opts.bottom!==t){o=r.height()-u.height()-n.opts.bottom}else if(n.opts.middle){o=(r.height()-u.height())/2}a.css("top",o+"px").css("left",s+"px").append(u)}r.first().prepend(a);i=c.add(n,"panel",a);C(n,a,i);a=null};this.marker=function(t){var u="values"in t.todo,a=!h;if(!u){t.opts.position=t.latLng||L(t.opts.position);t.todo.values=[{options:t.opts}]}if(!t.todo.values.length){C(t,false);return}if(a){O()}if(t.todo.cluster&&!h.getBounds()){google.maps.event.addListenerOnce(h,"bounds_changed",function(){i.marker.apply(i,[t])});return}if(t.todo.cluster){var f,p;if(t.todo.cluster instanceof m){f=t.todo.cluster;p=c.getById(f.id(),true)}else{p=_(t.todo.cluster);f=new m(s(t.todo.id,true),p);c.add(t,"clusterer",f,p)}p.beginUpdate();e.each(t.todo.values,function(e,n){var r=l(t,n);r.options.position=r.options.position?L(r.options.position):L(n);r.options.map=h;if(a){h.setCenter(r.options.position);a=false}p.add(r,n)});p.endUpdate();C(t,f)}else{var d=[];e.each(t.todo.values,function(e,i){var s,u,f=l(t,i);f.options.position=f.options.position?L(f.options.position):L(i);f.options.map=h;if(a){h.setCenter(f.options.position);a=false}u=new n.classes.Marker(f.options);d.push(u);s=c.add({todo:f},"marker",u);o(r,{todo:f},u,s)});C(t,u?d:d[0])}};this.getroute=function(e){e.opts.origin=L(e.opts.origin,true);e.opts.destination=L(e.opts.destination,true);E().route(e.opts,function(t,n){w(e,n==google.maps.DirectionsStatus.OK?t:false,n);d.ack()})};this.directionsrenderer=function(t){t.opts.map=h;var n,r=new google.maps.DirectionsRenderer(t.opts);if(t.todo.divId){r.setPanel(document.getElementById(t.todo.divId))}else if(t.todo.container){r.setPanel(e(t.todo.container).get(0))}n=c.add(t,"directionrenderer",r);C(t,r,n)};this.getgeoloc=function(e){C(e,e.latLng)};this.styledmaptype=function(e){O();var t=new n.classes.StyledMapType(e.todo.styles,e.opts);h.mapTypes.set(e.todo.id,t);C(e,t)};this.imagemaptype=function(e){O();var t=new n.classes.ImageMapType(e.opts);h.mapTypes.set(e.todo.id,t);C(e,t)};this.autofit=function(t){var n=new google.maps.LatLngBounds;e.each(c.all(),function(e,t){if(t.getPosition){n.extend(t.getPosition())}else if(t.getBounds){n.extend(t.getBounds().getNorthEast());n.extend(t.getBounds().getSouthWest())}else if(t.getPaths){t.getPaths().forEach(function(e){e.forEach(function(e){n.extend(e)})})}else if(t.getPath){t.getPath().forEach(function(e){n.extend(e);""})}else if(t.getCenter){n.extend(t.getCenter())}});if(!n.isEmpty()&&(!h.getBounds()||!h.getBounds().equals(n))){if("maxZoom"in t.todo){google.maps.event.addListenerOnce(h,"bounds_changed",function(){if(this.getZoom()>t.todo.maxZoom){this.setZoom(t.todo.maxZoom)}})}h.fitBounds(n)}C(t,true)};this.clear=function(t){if(typeof t.todo==="string"){if(c.clearById(t.todo)||c.objClearById(t.todo)){C(t,true);return}t.todo={name:t.todo}}if(t.todo.id){e.each(k(t.todo.id),function(e,t){c.clearById(t)})}else{c.clear(k(t.todo.name),t.todo.last,t.todo.first,t.todo.tag)}C(t,true)};this.exec=function(t){var n=this;e.each(k(t.todo.func),function(i,s){e.each(n.get(t.todo,true,t.todo.hasOwnProperty("full")?t.todo.full:true),function(e,t){s.call(r,t)})});C(t,true)};this.get=function(n,r,i){var s,o,u=r?n:n.todo;if(!r){i=u.full}if(typeof u==="string"){o=c.getById(u,false,i)||c.objGetById(u);if(o===false){s=u;u={}}}else{s=u.name}if(s==="map"){o=h}if(!o){o=[];if(u.id){e.each(k(u.id),function(e,t){o.push(c.getById(t,false,i)||c.objGetById(t))});if(!e.isArray(u.id)){o=o[0]}}else{e.each(s?k(s):[t],function(t,n){var r;if(u.first){r=c.get(n,false,u.tag,i);if(r)o.push(r)}else if(u.all){e.each(c.all(n,u.tag,i),function(e,t){o.push(t)})}else{r=c.get(n,true,u.tag,i);if(r)o.push(r)}});if(!u.all&&!e.isArray(s)){o=o[0]}}}o=e.isArray(o)||!u.all?o:[o];if(r){return o}else{C(n,o)}};this.getdistance=function(e){var t;e.opts.origins=k(e.opts.origins);for(t=0;t<e.opts.origins.length;t++){e.opts.origins[t]=L(e.opts.origins[t],true)}e.opts.destinations=k(e.opts.destinations);for(t=0;t<e.opts.destinations.length;t++){e.opts.destinations[t]=L(e.opts.destinations[t],true)}T().getDistanceMatrix(e.opts,function(t,n){w(e,n===google.maps.DistanceMatrixStatus.OK?t:false,n);d.ack()})};this.trigger=function(t){if(typeof t.todo==="string"){google.maps.event.trigger(h,t.todo)}else{var n=[h,t.todo.eventName];if(t.todo.var_args){e.each(t.todo.var_args,function(e,t){n.push(t)})}google.maps.event.trigger.apply(google.maps.event,n)}w(t);d.ack()}}function P(e){var t;if(!typeof e==="object"||!e.hasOwnProperty("get")){return false}for(t in e){if(t!=="get"){return false}}return!e.get.hasOwnProperty("callback")}var n,r=0;var y={},b=new h;e.fn.gmap3=function(){var t,n=[],r=true,s=[];i();for(t=0;t<arguments.length;t++){if(arguments[t]){n.push(arguments[t])}}if(!n.length){n.push("map")}e.each(this,function(){var t=e(this),i=t.data("gmap3");r=false;if(!i){i=new D(t);t.data("gmap3",i)}if(n.length===1&&(n[0]==="get"||P(n[0]))){s.push(i.get(n[0]==="get"?"map":n[0].get,true))}else{i._plan(n)}});if(s.length){if(s.length===1){return s[0]}else{return s}}return this}})(jQuery)